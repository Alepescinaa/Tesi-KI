---
title: "Performance Comparison"
author: "Alessandra Pescina"
date: "2024-12-16"
output: html_document
---

```{r setup, include=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(fs)
library(parallel)
library(ggplot2)
library(dplyr)
library(tidyr)
library(patchwork)
library(here)
library(kableExtra)
library(plotly)
```

```{r}
setwd(here())

path <- "./wrapper_MM/plots_500/"
files <- list.files(path, pattern = "\\.RData$", full.names = TRUE)
lapply(files, load, .GlobalEnv)

conv_table500 <- conv_table
remove(conv_table)

mean_ct500 <- mean_ct
remove(mean_ct)

plots_bias500 <- plots_bias
remove(plots_bias)

plots_cov500 <- plots_cov
remove(plots_cov)

plots_errorI500 <- plots_errorI
remove(plots_errorI)

plots_power500 <- plots_power
remove(plots_power)

plots_distr500 <- plots_distr
remove(plots_distr)
```


```{r}
path <- "./wrapper_MM/plots_2K/"
files <- list.files(path, pattern = "\\.RData$", full.names = TRUE)
lapply(files, load, .GlobalEnv)

conv_table2K <- conv_table
remove(conv_table)

mean_ct2K <- mean_ct
remove(mean_ct)

plots_bias2K <- plots_bias
remove(plots_bias)

plots_cov2K <- plots_cov
remove(plots_cov)

plots_errorI2K <- plots_errorI
remove(plots_errorI)

plots_power2K <- plots_power
remove(plots_power)

plots_distr2K <- plots_distr
remove(plots_distr)
```


```{r}
path <- "./wrapper_MM/plots_5K/"
files <- list.files(path, pattern = "\\.RData$", full.names = TRUE)
lapply(files, load, .GlobalEnv)

conv_table5K <- conv_table
remove(conv_table)

mean_ct5K <- mean_ct
remove(mean_ct)

plots_bias5K<- plots_bias
remove(plots_bias)

plots_cov5K <- plots_cov
remove(plots_cov)

plots_errorI5K <- plots_errorI
remove(plots_errorI)

plots_power5K <- plots_power
remove(plots_power)

plots_distr5K <- plots_distr
remove(plots_distr)
```


```{r}
path <- "./wrapper_MM/plots_10K/"
files <- list.files(path, pattern = "\\.RData$", full.names = TRUE)
lapply(files, load, .GlobalEnv)

conv_table10K <- conv_table
remove(conv_table)

mean_ct10K <- mean_ct
remove(mean_ct)

plots_bias10K<- plots_bias
remove(plots_bias)

plots_cov10K <- plots_cov
remove(plots_cov)

plots_errorI10K <- plots_errorI
remove(plots_errorI)

plots_power10K <- plots_power
remove(plots_power)

plots_distr10K <- plots_distr
remove(plots_distr)
```

### Plots 500 observations

BIAS 500
```{r}
p1 <- plots_bias500[[1]] + labs(title= "1 year observation scheme")
p2 <- plots_bias500[[3]] + labs(title= "3 years observation scheme")
p3 <- plots_bias500[[5]] + labs(title= "3-6 years observation scheme")
p4 <- plots_bias500[[7]] + labs(title= "irregular observation scheme")

bias_500 <- (p1+p2) / (p3+p4) + plot_layout(guides = "collect") 
bias_500 & 
  ylim(0, 4)

```

COVERAGE 500
```{r, warning=FALSE}
p1 <- plots_cov500[[1]] + labs(title= "1 year observation scheme")
p2 <- plots_cov500[[2]] + labs(title= "3 years observation scheme")
p3 <- plots_cov500[[3]] + labs(title= "3-6 years observation scheme")
p4 <- plots_cov500[[4]] + labs(title= "irregular observation scheme")


cov_500 <- (p1+p2) / (p3+p4) + plot_layout(guides = "collect") 
cov_500
```
ERROR TYPE I 500

```{r}
p1 <- plots_errorI500[[1]][[1]] + labs(title = NULL,  x = "1 year observation scheme")+ theme(legend.position = "none")
p2 <- plots_errorI500[[2]][[1]] + labs(title = NULL,  x = "3 years observation scheme") 
p3 <- plots_errorI500[[3]][[1]] + labs(title = NULL, x = "3-6 years observation scheme")
p4 <- plots_errorI500[[4]][[1]] + labs(title = NULL,  x = "irregular observation scheme") 

typeIerror_500_trans1 <- (p1 + p2) / (p3 + p4) +
                  plot_layout(guides = "collect", widths = unit(rep(1, 4), "null")) +
                  plot_annotation(
                    title ="Heatmap of Type I Error by Method and Covariate for transition Dementia-free -> Dementia", 
                    theme = theme(plot.title = element_text(size = 15, hjust = 0.5)),
                  ) 
p1 <- plots_errorI500[[1]][[2]] + labs(title = NULL,  x = "1 year observation scheme") + theme(legend.position = "none")
p2 <- plots_errorI500[[2]][[2]] + labs(title = NULL,  x = "3 years observation scheme") 
p3 <- plots_errorI500[[3]][[2]] + labs(title = NULL, x = "3-6 years observation scheme") 
p4 <- plots_errorI500[[4]][[2]] + labs(title = NULL,  x = "irregular observation scheme") 

typeIerror_500_trans3 <- (p1 + p2 )/ (p3 + p4) +
                  plot_layout(guides = "collect", widths = unit(rep(1, 4), "null")) +
                  plot_annotation(
                    title ="Heatmap of Type I Error by Method and Covariate for transition Dementia -> Death", 
                    theme = theme(plot.title = element_text(size = 15, hjust = 0.5)),
                  ) 


typeIerror_500_trans1
typeIerror_500_trans3

```

POWER 500

```{r}
p1 <- plots_power500[[1]] + labs(title =NULL, x = "1 year observation scheme")
p2 <- plots_power500[[4]] + labs(title =NULL, x = "3 years observation scheme")
p3 <- plots_power500[[7]] + labs(title =NULL, x = "3-6 years observation scheme")
p4 <- plots_power500[[10]] +labs(title =NULL, x = "irregular observation scheme")

power_500_trans1 <- (p1 + p2) / (p3 + p4) + 
  plot_layout(guides = "collect") + plot_annotation(
  title ="Heatmap of Power by Method and Covariate for transition Dementia-free -> Dementia",  
  theme = theme(plot.title = element_text(size = 15, hjust = 0.5)))+  
  plot_layout(guides = "collect")

p1 <- plots_power500[[2]] + labs(title =NULL, x = "1 year observation scheme")
p2 <- plots_power500[[5]] + labs(title =NULL, x = "3 years observation scheme")
p3 <- plots_power500[[8]] + labs(title =NULL, x = "3-6 years observation scheme")
p4 <- plots_power500[[11]] +labs(title =NULL, x = "irregular observation scheme")

power_500_trans2 <- (p1 + p2) / (p3 + p4) + 
  plot_layout(guides = "collect") + plot_annotation(
  title ="Heatmap of Power by Method and Covariate for transition Dementia-free -> Death",  
  theme = theme(plot.title = element_text(size = 15, hjust = 0.5)))+  
  plot_layout(guides = "collect")

p1 <- plots_power500[[3]] + labs(title =NULL, x = "1 year observation scheme")
p2 <- plots_power500[[6]] + labs(title =NULL, x = "3 years observation scheme")
p3 <- plots_power500[[9]] + labs(title =NULL, x = "3-6 years observation scheme")
p4 <- plots_power500[[12]] +labs(title =NULL, x = "irregular observation scheme")

power_500_trans3 <- (p1 + p2) / (p3 + p4) + 
  plot_layout(guides = "collect") + plot_annotation(
  title ="Heatmap of Power by Method and Covariate for transition Dementia -> Death",  
  theme = theme(plot.title = element_text(size = 15, hjust = 0.5)))+  
  plot_layout(guides = "collect")
  
power_500_trans1
power_500_trans2
power_500_trans3
```

COEFFICIENTS DISTRIBUTION 500
```{r, warning=FALSE, message=FALSE} 
p1 <- plots_distr500[[1]][[1]] + 
  labs(title = NULL, x = "1 year observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

p2 <- plots_distr500[[2]][[1]] + 
  labs(title = NULL, x = "3 years observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

p3 <- plots_distr500[[3]][[1]] + 
  labs(title = NULL, x = "3-6 years observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

p4 <- plots_distr500[[4]][[1]] + 
  labs(title = NULL, x = "irregular observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

distr_500_trans1 <- (p1 + p2) / (p3 + p4) + 
  plot_layout(guides = "collect") + plot_annotation(
  title ="Coefficients density distribution for transition Dementia-free -> Dementia",  
  theme = theme(plot.title = element_text(size = 15, hjust = 0.5)))+  
  plot_layout(guides = "collect")

p1 <- plots_distr500[[1]][[2]] + 
  labs(title = NULL, x = "1 year observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

p2 <- plots_distr500[[2]][[2]] + 
  labs(title = NULL, x = "3 years observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

p3 <- plots_distr500[[3]][[2]] + 
  labs(title = NULL, x = "3-6 years observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

p4 <- plots_distr500[[4]][[2]] + 
  labs(title = NULL, x = "irregular observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

distr_500_trans2 <- (p1 + p2) / (p3 + p4) + 
  plot_layout(guides = "collect") + plot_annotation(
  title ="Coefficients density distribution for transition Dementia-free -> Death",  
  theme = theme(plot.title = element_text(size = 15, hjust = 0.5)))+  
  plot_layout(guides = "collect")

p1 <- plots_distr500[[1]][[3]] + 
  labs(title = NULL, x = "1 year observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

p2 <- plots_distr500[[2]][[3]] + 
  labs(title = NULL, x = "3 years observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

p3 <- plots_distr500[[3]][[3]] + 
  labs(title = NULL, x = "3-6 years observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

p4 <- plots_distr500[[4]][[3]] + 
  labs(title = NULL, x = "irregular observation scheme") + 
  theme(axis.title.x = element_text(size = 8))
distr_500_trans3 <- (p1 + p2) / (p3 + p4) + 
  plot_layout(guides = "collect") + plot_annotation(
  title ="Coefficients density distribution for transition Dementia -> Death",  
  theme = theme(plot.title = element_text(size = 14, hjust = 0.5)))+  
  plot_layout(guides = "collect")
  
distr_500_trans1
distr_500_trans2
distr_500_trans3
```
### Plots 2K observations

BIAS_2K
```{r}
p1 <- plots_bias2K[[1]] + labs(title= "1 year observation scheme")
p2 <- plots_bias2K[[3]] + labs(title= "3 years observation scheme")
p3 <- plots_bias2K[[5]] + labs(title= "3-6 years observation scheme")
p4 <- plots_bias2K[[7]] + labs(title= "irregular observation scheme")

plots_bias_2K <- (p1+p2) / 
                 (p3+p4) +
                 plot_layout(guides = "collect")
plots_bias_2K & 
  ylim(0, 2)
```

COVERAGE 2K
```{r, warning=FALSE}
p1 <- plots_cov2K[[1]] + labs(title= "1 year observation scheme")
p2 <- plots_cov2K[[2]] + labs(title= "3 years observation scheme")
p3 <- plots_cov2K[[3]] + labs(title= "3-6 years observation scheme")
p4 <- plots_cov2K[[4]] + labs(title= "irregular observation scheme")

cov_2K <- (p1+p2) / (p3+p4) + plot_layout(guides = "collect")
cov_2K
```

ERROR TYPE I 2K
```{r}
p1 <- plots_errorI2K[[1]][[1]] + labs(title = NULL,  x = "1 year observation scheme")+ theme(legend.position = "none")
p2 <- plots_errorI2K[[2]][[1]] + labs(title = NULL,  x = "3 years observation scheme") 
p3 <- plots_errorI2K[[3]][[1]] + labs(title = NULL, x = "3-6 years observation scheme")
p4 <- plots_errorI2K[[4]][[1]] + labs(title = NULL,  x = "irregular observation scheme") 

typeIerror_2K_trans1 <- (p1 + p2) / (p3 + p4) +
                  plot_layout(guides = "collect", widths = unit(rep(1, 4), "null")) +
                  plot_annotation(
                    title ="Heatmap of Type I Error by Method and Covariate for transition Dementia-free -> Dementia", 
                    theme = theme(plot.title = element_text(size = 15, hjust = 0.5)),
                  ) 
p1 <- plots_errorI2K[[1]][[2]] + labs(title = NULL,  x = "1 year observation scheme") 
p2 <- plots_errorI2K[[2]][[2]] + labs(title = NULL,  x = "3 years observation scheme") + theme(legend.position = "none")
p3 <- plots_errorI2K[[3]][[2]] + labs(title = NULL, x = "3-6 years observation scheme") + theme(legend.position = "none")
p4 <- plots_errorI2K[[4]][[2]] + labs(title = NULL,  x = "irregular observation scheme") + theme(legend.position = "none")

typeIerror_2K_trans3 <- (p1 + p2 )/ (p3 + p4) +
                  plot_layout(guides = "collect", widths = unit(rep(1, 4), "null")) +
                  plot_annotation(
                    title ="Heatmap of Type I Error by Method and Covariate for transition Dementia -> Death", 
                    theme = theme(plot.title = element_text(size = 15, hjust = 0.5)),
                  ) 


typeIerror_2K_trans1
typeIerror_2K_trans3

```

POWER 2K
```{r}
p1 <- plots_power2K[[1]] + labs(title =NULL, x = "1 year observation scheme")
p2 <- plots_power2K[[4]] + labs(title =NULL, x = "3 years observation scheme")
p3 <- plots_power2K[[7]] + labs(title =NULL, x = "3-6 years observation scheme")
p4 <- plots_power2K[[10]] +labs(title =NULL, x = "irregular observation scheme")

power_2K_trans1 <- (p1 + p2) / (p3 + p4) + 
  plot_layout(guides = "collect") + plot_annotation(
  title ="Heatmap of Power by Method and Covariate for transition Dementia-free -> Dementia",  
  theme = theme(plot.title = element_text(size = 15, hjust = 0.5)))+  
  plot_layout(guides = "collect")

p1 <- plots_power2K[[2]] + labs(title =NULL, x = "1 year observation scheme")
p2 <- plots_power2K[[5]] + labs(title =NULL, x = "3 years observation scheme")+ theme(legend.position = "none")
p3 <- plots_power2K[[8]] + labs(title =NULL, x = "3-6 years observation scheme")+ theme(legend.position = "none")
p4 <- plots_power2K[[11]] +labs(title =NULL, x = "irregular observation scheme")

power_2K_trans2 <- (p1 + p2) / (p3 + p4) + 
  plot_layout(guides = "collect") + plot_annotation(
  title ="Heatmap of Power by Method and Covariate for transition Dementia-free -> Death",  
  theme = theme(plot.title = element_text(size = 15, hjust = 0.5)))+  
  plot_layout(guides = "collect")

p1 <- plots_power2K[[3]] + labs(title =NULL, x = "1 year observation scheme")
p2 <- plots_power2K[[6]] + labs(title =NULL, x = "3 years observation scheme")
p3 <- plots_power2K[[9]] + labs(title =NULL, x = "3-6 years observation scheme")
p4 <- plots_power2K[[12]] +labs(title =NULL, x = "irregular observation scheme")

power_2K_trans3 <- (p1 + p2) / (p3 + p4) + 
  plot_layout(guides = "collect") + plot_annotation(
  title ="Heatmap of Power by Method and Covariate for transition Dementia -> Death",  
  theme = theme(plot.title = element_text(size = 15, hjust = 0.5)))+  
  plot_layout(guides = "collect")
  
power_2K_trans1
power_2K_trans2
power_2K_trans3
```
COEFFICIENTS DISTRIBUTION 2K
```{r, warning=FALSE, message=FALSE} 
p1 <- plots_distr2K[[1]][[1]] + 
  labs(title = NULL, x = "1 year observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

p2 <- plots_distr2K[[2]][[1]] + 
  labs(title = NULL, x = "3 years observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

p3 <- plots_distr2K[[3]][[1]] + 
  labs(title = NULL, x = "3-6 years observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

p4 <- plots_distr2K[[4]][[1]] + 
  labs(title = NULL, x = "irregular observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

distr_2K_trans1 <- (p1 + p2) / (p3 + p4) + 
  plot_layout(guides = "collect") + plot_annotation(
  title ="Coefficients density distribution for transition Dementia-free -> Dementia",  
  theme = theme(plot.title = element_text(size = 15, hjust = 0.5)))+  
  plot_layout(guides = "collect")

p1 <- plots_distr2K[[1]][[2]] + 
  labs(title = NULL, x = "1 year observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

p2 <- plots_distr2K[[2]][[2]] + 
  labs(title = NULL, x = "3 years observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

p3 <- plots_distr2K[[3]][[2]] + 
  labs(title = NULL, x = "3-6 years observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

p4 <- plots_distr2K[[4]][[2]] + 
  labs(title = NULL, x = "irregular observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

distr_2K_trans2 <- (p1 + p2) / (p3 + p4) + 
  plot_layout(guides = "collect") + plot_annotation(
  title ="Coefficients density distribution for transition Dementia-free -> Death",  
  theme = theme(plot.title = element_text(size = 15, hjust = 0.5)))+  
  plot_layout(guides = "collect")

p1 <- plots_distr2K[[1]][[3]] + 
  labs(title = NULL, x = "1 year observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

p2 <- plots_distr2K[[2]][[3]] + 
  labs(title = NULL, x = "3 years observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

p3 <- plots_distr2K[[3]][[3]] + 
  labs(title = NULL, x = "3-6 years observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

p4 <- plots_distr2K[[4]][[3]] + 
  labs(title = NULL, x = "irregular observation scheme") + 
  theme(axis.title.x = element_text(size = 8))
distr_2K_trans3 <- (p1 + p2) / (p3 + p4) + 
  plot_layout(guides = "collect") + plot_annotation(
  title ="Coefficients density distribution for transition Dementia -> Death",  
  theme = theme(plot.title = element_text(size = 14, hjust = 0.5)))+  
  plot_layout(guides = "collect")
  
distr_2K_trans1
distr_2K_trans2
distr_2K_trans3
```

### Plots 5K observations

BIAS_5K
```{r}
p1 <- plots_bias5K[[1]] + labs(title= "1 year observation scheme")
p2 <- plots_bias5K[[3]] + labs(title= "3 years observation scheme")
p3 <- plots_bias5K[[5]] + labs(title= "3-6 years observation scheme")
p4 <- plots_bias5K[[7]] + labs(title= "irregular observation scheme")

plots_bias_5K <- (p1+p2) / 
                 (p3+p4) +
                 plot_layout(guides = "collect")
plots_bias_5K & 
  ylim(0, 1)
```

COVERAGE 5K
```{r, warning=FALSE}

p1 <- plots_cov5K[[1]] + labs(title= "1 year observation scheme")
p2 <- plots_cov5K[[2]] + labs(title= "3 years observation scheme")
p3 <- plots_cov5K[[3]] + labs(title= "3-6 years observation scheme")
p4 <- plots_cov5K[[4]] + labs(title= "irregular observation scheme")


cov_5K <- (p1+p2) / (p3+p4) +
                 plot_layout(guides = "collect")
cov_5K
```
ERROR TYPE I 5K
```{r}
p1 <- plots_errorI5K[[1]][[1]] + labs(title = NULL,  x = "1 year observation scheme")+ theme(legend.position = "none")
p2 <- plots_errorI5K[[2]][[1]] + labs(title = NULL,  x = "3 years observation scheme") 
p3 <- plots_errorI5K[[3]][[1]] + labs(title = NULL, x = "3-6 years observation scheme")
p4 <- plots_errorI5K[[4]][[1]] + labs(title = NULL,  x = "irregular observation scheme") 

typeIerror_5K_trans1 <- (p1 + p2) / (p3 + p4) +
                  plot_layout(guides = "collect", widths = unit(rep(1, 4), "null")) +
                  plot_annotation(
                    title ="Heatmap of Type I Error by Method and Covariate for transition Dementia-free -> Dementia", 
                    theme = theme(plot.title = element_text(size = 15, hjust = 0.5)),
                  ) 
p1 <- plots_errorI5K[[1]][[2]] + labs(title = NULL,  x = "1 year observation scheme") + theme(legend.position = "none")
p2 <- plots_errorI5K[[2]][[2]] + labs(title = NULL,  x = "3 years observation scheme") 
p3 <- plots_errorI5K[[3]][[2]] + labs(title = NULL, x = "3-6 years observation scheme") 
p4 <- plots_errorI5K[[4]][[2]] + labs(title = NULL,  x = "irregular observation scheme") 

typeIerror_5K_trans3 <- (p1 + p2 )/ (p3 + p4) +
                  plot_layout(guides = "collect", widths = unit(rep(1, 4), "null")) +
                  plot_annotation(
                    title ="Heatmap of Type I Error by Method and Covariate for transition Dementia -> Death", 
                    theme = theme(plot.title = element_text(size = 15, hjust = 0.5)),
                  ) 


typeIerror_5K_trans1
typeIerror_5K_trans3

```

POWER 5K
```{r}
p1 <- plots_power5K[[1]] + labs(title =NULL, x = "1 year observation scheme")+theme(legend.position = "none")
p2 <- plots_power5K[[4]] + labs(title =NULL, x = "3 years observation scheme")
p3 <- plots_power5K[[7]] + labs(title =NULL, x = "3-6 years observation scheme")
p4 <- plots_power5K[[10]] +labs(title =NULL, x = "irregular observation scheme")

power_5K_trans1 <- (p1 + p2) / (p3 + p4) + 
  plot_layout(guides = "collect") + plot_annotation(
  title ="Heatmap of Power by Method and Covariate for transition Dementia-free -> Dementia",  
  theme = theme(plot.title = element_text(size = 15, hjust = 0.5)))+  
  plot_layout(guides = "collect")

p1 <- plots_power5K[[2]] + labs(title =NULL, x = "1 year observation scheme")
p2 <- plots_power5K[[5]] + labs(title =NULL, x = "3 years observation scheme")
p3 <- plots_power5K[[8]] + labs(title =NULL, x = "3-6 years observation scheme")
p4 <- plots_power5K[[11]] +labs(title =NULL, x = "irregular observation scheme")

power_5K_trans2 <- (p1 + p2) / (p3 + p4) + 
  plot_layout(guides = "collect") + plot_annotation(
  title ="Heatmap of Power by Method and Covariate for transition Dementia-free -> Death",  
  theme = theme(plot.title = element_text(size = 15, hjust = 0.5)))+  
  plot_layout(guides = "collect")

p1 <- plots_power5K[[3]] + labs(title =NULL, x = "1 year observation scheme")
p2 <- plots_power5K[[6]] + labs(title =NULL, x = "3 years observation scheme")
p3 <- plots_power5K[[9]] + labs(title =NULL, x = "3-6 years observation scheme")
p4 <- plots_power5K[[12]] +labs(title =NULL, x = "irregular observation scheme")

power_5K_trans3 <- (p1 + p2) / (p3 + p4) + 
  plot_layout(guides = "collect") + plot_annotation(
  title ="Heatmap of Power by Method and Covariate for transition Dementia -> Death",  
  theme = theme(plot.title = element_text(size = 15, hjust = 0.5)))+  
  plot_layout(guides = "collect")
  
power_5K_trans1
power_5K_trans2
power_5K_trans3
```

COEFFICIENTS DISTRIBUTION 5K
```{r, warning=FALSE, message=FALSE} 
p1 <- plots_distr5K[[1]][[1]] + 
  labs(title = NULL, x = "1 year observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

p2 <- plots_distr5K[[2]][[1]] + 
  labs(title = NULL, x = "3 years observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

p3 <- plots_distr5K[[3]][[1]] + 
  labs(title = NULL, x = "3-6 years observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

p4 <- plots_distr5K[[4]][[1]] + 
  labs(title = NULL, x = "irregular observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

distr_5K_trans1 <- (p1 + p2) / (p3 + p4) + 
  plot_layout(guides = "collect") + plot_annotation(
  title ="Coefficients density distribution for transition Dementia-free -> Dementia",  
  theme = theme(plot.title = element_text(size = 15, hjust = 0.5)))+  
  plot_layout(guides = "collect")

p1 <- plots_distr5K[[1]][[2]] + 
  labs(title = NULL, x = "1 year observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

p2 <- plots_distr5K[[2]][[2]] + 
  labs(title = NULL, x = "3 years observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

p3 <- plots_distr5K[[3]][[2]] + 
  labs(title = NULL, x = "3-6 years observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

p4 <- plots_distr5K[[4]][[2]] + 
  labs(title = NULL, x = "irregular observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

distr_5K_trans2 <- (p1 + p2) / (p3 + p4) + 
  plot_layout(guides = "collect") + plot_annotation(
  title ="Coefficients density distribution for transition Dementia-free -> Death",  
  theme = theme(plot.title = element_text(size = 15, hjust = 0.5)))+  
  plot_layout(guides = "collect")

p1 <- plots_distr5K[[1]][[3]] + 
  labs(title = NULL, x = "1 year observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

p2 <- plots_distr5K[[2]][[3]] + 
  labs(title = NULL, x = "3 years observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

p3 <- plots_distr5K[[3]][[3]] + 
  labs(title = NULL, x = "3-6 years observation scheme") + 
  theme(axis.title.x = element_text(size = 8))

p4 <- plots_distr5K[[4]][[3]] + 
  labs(title = NULL, x = "irregular observation scheme") + 
  theme(axis.title.x = element_text(size = 8))
distr_5K_trans3 <- (p1 + p2) / (p3 + p4) + 
  plot_layout(guides = "collect") + plot_annotation(
  title ="Coefficients density distribution for transition Dementia -> Death",  
  theme = theme(plot.title = element_text(size = 14, hjust = 0.5)))+  
  plot_layout(guides = "collect")
  
distr_5K_trans1
distr_5K_trans2
distr_5K_trans3
```

### Plots 10K observations

BIAS_10K
```{r}
p1 <- plots_bias10K[[1]] + labs(title= "1 year observation scheme")
p2 <- plots_bias10K[[3]] + labs(title= "3 years observation scheme")
p3 <- plots_bias10K[[5]] + labs(title= "3-6 years observation scheme")
p4 <- plots_bias10K[[7]] + labs(title= "irregular observation scheme")

plots_bias_10K <- (p1+p2) / 
                 (p3+p4) +
                 plot_layout(guides = "collect")
plots_bias_10K & 
  ylim(0, 1)
```

COVERAGE 10K
```{r, warning=FALSE}

p1 <- plots_cov10K[[1]] + labs(title= "1 year observation scheme")
p2 <- plots_cov10K[[2]] + labs(title= "3 years observation scheme")
p3 <- plots_cov10K[[3]] + labs(title= "3-6 years observation scheme")
p4 <- plots_cov10K[[4]] + labs(title= "irregular observation scheme")


cov_10K <- (p1+p2) / (p3+p4) +
                 plot_layout(guides = "collect")
cov_10K
```

ERROR TYPE I 10K
```{r}
p1 <- plots_errorI10K[[1]][[1]] + labs(title = NULL,  x = "1 year observation scheme")+ theme(legend.position = "none")
p2 <- plots_errorI10K[[2]][[1]] + labs(title = NULL,  x = "3 years observation scheme") 
p3 <- plots_errorI10K[[3]][[1]] + labs(title = NULL, x = "3-6 years observation scheme")
p4 <- plots_errorI10K[[4]][[1]] + labs(title = NULL,  x = "irregular observation scheme") 

typeIerror_10K_trans1 <- (p1 + p2) / (p3 + p4) +
                  plot_layout(guides = "collect", widths = unit(rep(1, 4), "null")) +
                  plot_annotation(
                    title ="Heatmap of Type I Error by Method and Covariate for transition Dementia-free -> Dementia", 
                    theme = theme(plot.title = element_text(size = 15, hjust = 0.5)),
                  ) 
p1 <- plots_errorI10K[[1]][[2]] + labs(title = NULL,  x = "1 year observation scheme") + theme(legend.position = "none")
p2 <- plots_errorI10K[[2]][[2]] + labs(title = NULL,  x = "3 years observation scheme") 
p3 <- plots_errorI10K[[3]][[2]] + labs(title = NULL, x = "3-6 years observation scheme") 
p4 <- plots_errorI10K[[4]][[2]] + labs(title = NULL,  x = "irregular observation scheme") 

typeIerror_10K_trans3 <- (p1 + p2 )/ (p3 + p4) +
                  plot_layout(guides = "collect", widths = unit(rep(1, 4), "null")) +
                  plot_annotation(
                    title ="Heatmap of Type I Error by Method and Covariate for transition Dementia -> Death", 
                    theme = theme(plot.title = element_text(size = 15, hjust = 0.5)),
                  ) 


typeIerror_10K_trans1
typeIerror_10K_trans3

```


POWER 10K
```{r}
p1 <- plots_power10K[[1]] + labs(title =NULL, x = "1 year observation scheme")+theme(legend.position = "none")
p2 <- plots_power10K[[4]] + labs(title =NULL, x = "3 years observation scheme")
p3 <- plots_power10K[[7]] + labs(title =NULL, x = "3-6 years observation scheme")
p4 <- plots_power10K[[10]] +labs(title =NULL, x = "irregular observation scheme")

power_10K_trans1 <- (p1 + p2) / (p3 + p4) + 
  plot_layout(guides = "collect") + plot_annotation(
  title ="Heatmap of Power by Method and Covariate for transition Dementia-free -> Dementia",  
  theme = theme(plot.title = element_text(size = 15, hjust = 0.5)))+  
  plot_layout(guides = "collect")

p1 <- plots_power10K[[2]] + labs(title =NULL, x = "1 year observation scheme")
p2 <- plots_power10K[[5]] + labs(title =NULL, x = "3 years observation scheme")
p3 <- plots_power10K[[8]] + labs(title =NULL, x = "3-6 years observation scheme")
p4 <- plots_power10K[[11]] +labs(title =NULL, x = "irregular observation scheme")

power_10K_trans2 <- (p1 + p2) / (p3 + p4) + 
  plot_layout(guides = "collect") + plot_annotation(
  title ="Heatmap of Power by Method and Covariate for transition Dementia-free -> Death",  
  theme = theme(plot.title = element_text(size = 15, hjust = 0.5)))+  
  plot_layout(guides = "collect")

p1 <- plots_power10K[[3]] + labs(title =NULL, x = "1 year observation scheme")
p2 <- plots_power10K[[6]] + labs(title =NULL, x = "3 years observation scheme")
p3 <- plots_power10K[[9]] + labs(title =NULL, x = "3-6 years observation scheme")
p4 <- plots_power10K[[12]] +labs(title =NULL, x = "irregular observation scheme")

power_10K_trans3 <- (p1 + p2) / (p3 + p4) + 
  plot_layout(guides = "collect") + plot_annotation(
  title ="Heatmap of Power by Method and Covariate for transition Dementia -> Death",  
  theme = theme(plot.title = element_text(size = 15, hjust = 0.5)))+  
  plot_layout(guides = "collect")
  
power_10K_trans1
power_10K_trans2
power_10K_trans3
```

### Comparing performances for different samples sizes for frequent and sporadic visits


CONVERGENCE
```{r}
t1 <- conv_table500 %>%
  select(scheme,model, `Convergence 2`) %>%
  mutate(conv500=`Convergence 2`, `Convergence 2`=NULL)
t2 <- conv_table2K %>%
  select(scheme,model, `Convergence 2`)%>%
  mutate(conv2K=`Convergence 2`, `Convergence 2`=NULL)
t3 <- conv_table5K %>%
  select(scheme,model, `Convergence 2`)%>%
  mutate(conv5K=`Convergence 2`, `Convergence 2`=NULL)
t4 <- conv_table5K %>%
  select(scheme,model, `Convergence 2`)%>%
  mutate(conv10K=`Convergence 2`, `Convergence 2`=NULL)

table_convergence <- full_join(t1,t2)
table_convergence <- full_join(table_convergence,t3)
table_convergence <- full_join(table_convergence,t4)


conv_long <- table_convergence %>%
  pivot_longer(cols = starts_with("conv"), names_to = "sample_size", values_to = "convergence") 
conv_long <- conv_long %>%
    mutate(
      sample_size = case_when(
        sample_size == "conv500" ~ "500 observations",
        sample_size == "conv2K" ~ "2K observations",
        sample_size == "conv5K" ~ "5K observations",
        sample_size == "conv10K" ~ "10K observations",
      )) %>%
  mutate(
     scheme = case_when(
        scheme == "2" ~ "1 year",
        scheme == "3" ~ "3 years",
        scheme == "4" ~ "3-6 years",
        scheme == "5" ~ "irregular",
        )) %>%
  mutate(sample_size = factor(sample_size, levels = c("500 observations", "2K observations", "5K observations", "10K observations"))) %>%
  arrange(sample_size, scheme, model)

ggplot(conv_long, aes(x = scheme, y = model, fill = convergence)) +
  geom_tile(color = "white") +
  geom_text(aes(label = round(convergence, 1)), color = "black", size = 3) +
  facet_wrap(~sample_size) +
  scale_fill_gradient(low = "white", high = "blue", name = "Percentage") +
  labs(
    title = "Heatmap of Model Convergence",
    x = "Sample Size",
    y = "Model"
  ) +
  theme_minimal()

```


COMPUTATIONAL TIME
```{r}
t1 <- mean_ct500
t2 <- mean_ct2K
t3 <- mean_ct5K
t4 <- mean_ct10K

mean_ct_all <- rbind(t1,t2,t3,t4)
mean_ct_all$sample_size <- rep(1:4, each=4)


mean_ct_all <- mean_ct_all%>%
  pivot_longer(cols=c("a","b","c","d","e","f"),
               names_to = "model",
               values_to = "time")

ggplot(mean_ct_all, aes(x = sample_size, y = time, color = model, group = model)) +
  geom_line(size = 1) +
  geom_point(size = 2) +
  facet_wrap(~ scheme) +
  scale_x_discrete(labels = c("500", "2K", "5K", "10K")) +  
  scale_color_viridis_d() +
  labs(
    title = "Trend of Average Computational Time Across sample sizes and observation schemes",
    x = "Sample Size",
    y = "Time (s)",
    color = "Model"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
    axis.text.x = element_text(angle = 45, hjust = 1)
  )


```


BIAS COMPARISON (1 Year)
```{r}
p1 <- plots_bias500[[1]] + 
  labs(title =NULL, caption = "500 observations") +
  geom_point(size=0.5)
p2 <- plots_bias2K[[1]] + 
  labs(title= NULL, caption = "2K observations") +
  geom_point(size=0.5)
p3 <- plots_bias5K[[1]] + 
  labs(title= NULL, caption = "5K observations") +
  geom_point(size=0.5)
p4 <- plots_bias10K[[1]] + 
  labs(title= NULL, caption = "10K observations") +
  geom_point(size=0.5)


plots_bias_all <- ( p1+p2) / (p3+p4) +
                 plot_layout(guides = "collect") + 
  plot_annotation(title = "Bias comparison (1 year)",
    theme = theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5)))

plots_bias_all & 
  ylim(0, 1.5)
```


BIAS COMPARISON (3-6 years)
```{r}
p1 <- plots_bias500[[5]] + 
  labs(title =NULL, caption = "500 observations") +
  geom_point(size=0.5)
p2 <- plots_bias2K[[5]] + 
  labs(title= NULL, caption = "2K observations") +
  geom_point(size=0.5)
p3 <- plots_bias5K[[5]] + 
  labs(title= NULL, caption = "5K observations") +
  geom_point(size=0.5)
p4 <- plots_bias10K[[5]] + 
  labs(title= NULL, caption = "10K observations") +
  geom_point(size=0.5)


plots_bias_all <- ( p1+p2) / (p3+p4) +
                 plot_layout(guides = "collect") + 
  plot_annotation(title = "Bias comparison (3-6 years)",
    theme = theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5)))

plots_bias_all & 
  ylim(0, 3)
```


COVERAGE COMPARISON (1 year)
```{r, warning=FALSE}
p1 <- plots_cov500[[1]] + 
  labs(title =NULL, caption = "500 observations") +
  geom_point(size=0.5)
p2 <- plots_cov2K[[1]] + 
  labs(title= NULL, caption = "2K observations") +
  geom_point(size=0.5)
p3 <- plots_cov5K[[1]] + 
  labs(title= NULL, caption = "5K observations") +
  geom_point(size=0.5)
p4 <- plots_cov10K[[1]] + 
  labs(title= NULL, caption = "10K observations") +
  geom_point(size=0.5)

plots_cov_all <- ( p1+p2) / (p3+p4) +
                 plot_layout(guides = "collect") + 
  plot_annotation(title = "Coverage comparison (1 year)",
    theme = theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5)))

plots_cov_all & 
  ylim(0, 1)
```


COVERAGE COMPARISON (3-6 years)
```{r, warning=FALSE}
p1 <- plots_cov500[[3]] + 
  labs(title =NULL, caption = "500 observations") +
  geom_point(size=0.5)
p2 <- plots_cov2K[[3]] + 
  labs(title= NULL, caption = "2K observations") +
  geom_point(size=0.5)
p3 <- plots_cov5K[[3]] + 
  labs(title= NULL, caption = "5K observations") +
  geom_point(size=0.5)
p4 <- plots_cov10K[[3]] + 
  labs(title= NULL, caption = "10K observations") +
  geom_point(size=0.5)

plots_cov_all <- ( p1+p2) / (p3+p4) +
                 plot_layout(guides = "collect") + 
  plot_annotation(title = "Coverage comparison (3-6 years)",
    theme = theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5)))

plots_cov_all & 
  ylim(0, 1)
```


ERROR TYPE I COMPARISON (1 year)
```{r, warning=FALSE}
p1 <- plots_errorI500[[1]][[1]] + 
  labs(title =NULL, x=NULL, caption = "500 observations") +
  geom_point(size=0.5) 
p2 <- plots_errorI2K[[1]][[1]] + 
  labs(title= NULL, x=NULL, caption = "2K observations") +
  geom_point(size=0.5)
p3 <- plots_errorI5K[[1]][[1]] + 
  labs(title= NULL, x=NULL, caption = "5K observations") +
  geom_point(size=0.5)
p4 <- plots_errorI5K[[1]][[1]] + 
  labs(title= NULL, x=NULL, caption = "10K observations") +
  geom_point(size=0.5)

plots_errorI_all_trans1 <- ( p1+p2) / (p3+p4) +
                 plot_layout(guides = "collect") + 
  plot_annotation(title = "Type I error comparison on transition Dementia-free -> Dementia (3-6 years)",
    theme = theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5)))

p1 <- plots_errorI500[[1]][[2]] + 
  labs(title =NULL, x=NULL, caption = "500 observations") +
  geom_point(size=0.5)+ theme(legend.position = "none")
p2 <- plots_errorI2K[[1]][[2]] + 
  labs(title= NULL, x=NULL, caption = "2K observations") +
  geom_point(size=0.5)
p3 <- plots_errorI5K[[1]][[2]] + 
  labs(title= NULL, x=NULL, caption = "5K observations") +
  geom_point(size=0.5)+ theme(legend.position = "none")
p4 <- plots_errorI5K[[1]][[2]] + 
  labs(title= NULL, x=NULL, caption = "10K observations") +
  geom_point(size=0.5)+ theme(legend.position = "none")

plots_errorI_all_trans3 <- ( p1+p2) / (p3+p4) +
                 plot_layout(guides = "collect") + 
  plot_annotation(title = "Type I error comparison on transition Dementia-> Death (1 year)",
    theme = theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5)))

plots_errorI_all_trans1
plots_errorI_all_trans3
```


ERROR TYPE I COMPARISON (3-6)
```{r, warning=FALSE}
p1 <- plots_errorI500[[3]][[1]] + 
  labs(title =NULL, x=NULL, caption = "500 observations") +
  geom_point(size=0.5) 
p2 <- plots_errorI2K[[3]][[1]] + 
  labs(title= NULL, x=NULL, caption = "2K observations") +
  geom_point(size=0.5)
p3 <- plots_errorI5K[[3]][[1]] + 
  labs(title= NULL, x=NULL, caption = "5K observations") +
  geom_point(size=0.5)
p4 <- plots_errorI5K[[3]][[1]] + 
  labs(title= NULL, x=NULL, caption = "10K observations") +
  geom_point(size=0.5)

plots_errorI_all_trans1 <- ( p1+p2) / (p3+p4) +
                 plot_layout(guides = "collect") + 
  plot_annotation(title = "Type I error comparison on transition Dementia-free -> Dementia (3-6 years)",
    theme = theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5)))

p1 <- plots_errorI500[[3]][[2]] + 
  labs(title =NULL, x=NULL, caption = "500 observations") +
  geom_point(size=0.5) 
p2 <- plots_errorI2K[[3]][[2]] + 
  labs(title= NULL, x=NULL, caption = "2K observations") +
  geom_point(size=0.5)+ theme(legend.position = "none")
p3 <- plots_errorI5K[[3]][[2]] + 
  labs(title= NULL, x=NULL, caption = "5K observations") +
  geom_point(size=0.5)+ theme(legend.position = "none")
p4 <- plots_errorI5K[[3]][[2]] + 
  labs(title= NULL, x=NULL, caption = "10K observations") +
  geom_point(size=0.5)+ theme(legend.position = "none")

plots_errorI_all_trans3 <- ( p1+p2) / (p3+p4) +
                 plot_layout(guides = "collect") + 
  plot_annotation(title = "Type I error comparison on transition Dementia-> Death (3-6 years)",
    theme = theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5)))

plots_errorI_all_trans1
plots_errorI_all_trans3
```


POWER COMPARISON (1 year) 
```{r warning=FALSE}
p1 <- plots_power500[[1]] + 
  labs(title =NULL, x=NULL, caption = "500 observations") +
  geom_point(size=0.5)+ theme(legend.position = "none")
p2 <- plots_power2K[[1]] + 
  labs(title= NULL, x=NULL, caption = "2K observations") +
  geom_point(size=0.5)
p3 <- plots_power5K[[1]] + 
  labs(title= NULL, x=NULL, caption = "5K observations") +
  geom_point(size=0.5)+theme(legend.position = "none")
p4 <- plots_power5K[[1]] + 
  labs(title= NULL, x=NULL, caption = "10K observations") +
  geom_point(size=0.5)+theme(legend.position = "none")

plots_power_all_trans1 <- ( p1+p2) / (p3+p4) +
                 plot_layout(guides = "collect") + 
  plot_annotation(title = "Power comparison on transition Dementia-free -> Dementia (1 year)",
    theme = theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5)))

p1 <- plots_power500[[2]] + 
  labs(title =NULL, x=NULL, caption = "500 observations") +
  geom_point(size=0.5)
p2 <- plots_power2K[[2]] + 
  labs(title= NULL, x=NULL, caption = "2K observations") +
  geom_point(size=0.5)+ theme(legend.position = "none")
p3 <- plots_power5K[[2]] + 
  labs(title= NULL, x=NULL, caption = "5K observations") +
  geom_point(size=0.5)
p4 <- plots_power5K[[2]] + 
  labs(title= NULL, x=NULL, caption = "10K observations") +
  geom_point(size=0.5)

plots_power_all_trans2 <- ( p1+p2) / (p3+p4) +
                 plot_layout(guides = "collect") + 
  plot_annotation(title = "Power comparison on transition Dementia-free-> Death (1 year)",
    theme = theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5)))

p1 <- plots_power500[[3]] + 
  labs(title =NULL, x=NULL, caption = "500 observations") +
  geom_point(size=0.5)+ theme(legend.position = "none")
p2 <- plots_power2K[[3]] + 
  labs(title= NULL, x=NULL, caption = "2K observations") + theme(legend.position = "none")
  geom_point(size=0.5)
p3 <- plots_power5K[[3]] + 
  labs(title= NULL, x=NULL, caption = "5K observations") +
  geom_point(size=0.5)
p4 <- plots_power5K[[3]] + 
  labs(title= NULL, x=NULL, caption = "10K observations") +
  geom_point(size=0.5)

plots_power_all_trans3 <- ( p1+p2) / (p3+p4) +
                 plot_layout(guides = "collect") + 
  plot_annotation(title = "Power comparison on transition Dementia-> Death (1 year)",
    theme = theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5)))

plots_power_all_trans1
plots_power_all_trans2
plots_power_all_trans3
```


POWER COMPARISON (3-6 years)
```{r warning=FALSE}
p1 <- plots_power500[[7]] + 
  labs(title =NULL, x=NULL, caption = "500 observations") +
  geom_point(size=0.5)+ theme(legend.position = "none")
p2 <- plots_power2K[[7]] + 
  labs(title= NULL, x=NULL, caption = "2K observations") +
  geom_point(size=0.5)
p3 <- plots_power5K[[7]] + 
  labs(title= NULL, x=NULL, caption = "5K observations") +
  geom_point(size=0.5)
p4 <- plots_power5K[[7]] + 
  labs(title= NULL, x=NULL, caption = "10K observations") +
  geom_point(size=0.5)

plots_power_all_trans1 <- ( p1+p2) / (p3+p4) +
                 plot_layout(guides = "collect") + 
  plot_annotation(title = "Power comparison on transition Dementia-free -> Dementia (3-6 years)",
    theme = theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5)))

p1 <- plots_power500[[8]] + 
  labs(title =NULL, x=NULL, caption = "500 observations") +
  geom_point(size=0.5)
p2 <- plots_power2K[[8]] + 
  labs(title= NULL, x=NULL, caption = "2K observations") +
  geom_point(size=0.5)+ theme(legend.position = "none")
p3 <- plots_power5K[[8]] + 
  labs(title= NULL, x=NULL, caption = "5K observations") +
  geom_point(size=0.5)
p4 <- plots_power5K[[8]] + 
  labs(title= NULL, x=NULL, caption = "10K observations") +
  geom_point(size=0.5)

plots_power_all_trans2 <- ( p1+p2) / (p3+p4) +
                 plot_layout(guides = "collect") + 
  plot_annotation(title = "Power comparison on transition Dementia-free-> Death (3-6 years)",
    theme = theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5)))

p1 <- plots_power500[[9]] + 
  labs(title =NULL, x=NULL, caption = "500 observations") +
  geom_point(size=0.5)+ theme(legend.position = "none")
p2 <- plots_power2K[[9]] + 
  labs(title= NULL, x=NULL, caption = "2K observations") + theme(legend.position = "none")
  geom_point(size=0.5)
p3 <- plots_power5K[[9]] + 
  labs(title= NULL, x=NULL, caption = "5K observations") +
  geom_point(size=0.5)
p4 <- plots_power5K[[9]] + 
  labs(title= NULL, x=NULL, caption = "10K observations") +
  geom_point(size=0.5)

plots_power_all_trans3 <- ( p1+p2) / (p3+p4) +
                 plot_layout(guides = "collect") + 
  plot_annotation(title = "Power comparison on transition Dementia-> Death (3-6 years)",
    theme = theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5)))

plots_power_all_trans1
plots_power_all_trans2
plots_power_all_trans3
```


COEFFICIENT DISTRIBUTION (1 year)
```{r warning=FALSE, message=FALSE}
p1 <- plots_distr500[[1]][[1]] + 
  labs(title =NULL, x=NULL, caption = "500 observations") 
p2 <- plots_distr2K[[1]][[1]] + 
  labs(title= NULL, x=NULL, caption = "2K observations") 
p3 <- plots_distr5K[[1]][[1]] + 
  labs(title= NULL, x=NULL, caption = "5K observations") 
p4 <- plots_distr10K[[1]][[1]] + 
  labs(title= NULL, x=NULL, caption = "10K observations") 

plots_distr_all_trans1 <- ( p1+p2) / (p3+p4) +
                 plot_layout(guides = "collect") + 
  plot_annotation(title = "Coefficients distribution comparison on transition Dementia-free -> Dementia (1 year)",
    theme = theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5)))

p1 <- plots_distr500[[1]][[2]] + 
  labs(title =NULL, x=NULL, caption = "500 observations") 
p2 <- plots_distr2K[[1]][[2]] + 
  labs(title= NULL, x=NULL, caption = "2K observations") 
p3 <- plots_distr5K[[1]][[2]] + 
  labs(title= NULL, x=NULL, caption = "5K observations") 
p4 <- plots_distr10K[[1]][[2]] + 
  labs(title= NULL, x=NULL, caption = "10K observations") 

plots_distr_all_trans2 <- ( p1+p2) / (p3+p4) +
                 plot_layout(guides = "collect") + 
  plot_annotation(title = "Coefficients distribution comparison on transition Dementia-free-> Death (1 year)",
    theme = theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5)))

p1 <- plots_distr500[[1]][[3]] + 
  labs(title =NULL, x=NULL, caption = "500 observations") 
p2 <- plots_distr2K[[1]][[3]] + 
  labs(title= NULL, x=NULL, caption = "2K observations") 
p3 <- plots_distr5K[[1]][[3]] + 
  labs(title= NULL, x=NULL, caption = "5K observations") 
p4 <- plots_distr10K[[1]][[3]] + 
  labs(title= NULL, x=NULL, caption = "10K observations") 

plots_distr_all_trans3 <- ( p1+p2) / (p3+p4) +
                 plot_layout(guides = "collect") + 
  plot_annotation(title = "Coefficients distribution comparison on transition Dementia-> Death (1 year)",
    theme = theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5)))

plots_distr_all_trans1
plots_distr_all_trans2
plots_distr_all_trans3
```


COEFFICIENT DISTRIBUTION (3-6 years)
```{r warning=FALSE, message=FALSE}
p1 <- plots_distr500[[3]][[1]] + 
  labs(title =NULL, x=NULL, caption = "500 observations") 
p2 <- plots_distr2K[[3]][[1]] + 
  labs(title= NULL, x=NULL, caption = "2K observations") 
p3 <- plots_distr5K[[3]][[1]] + 
  labs(title= NULL, x=NULL, caption = "5K observations") 
p4 <- plots_distr10K[[3]][[1]] + 
  labs(title= NULL, x=NULL, caption = "10K observations") 

plots_distr_all_trans1 <- ( p1+p2) / (p3+p4) +
                 plot_layout(guides = "collect") + 
  plot_annotation(title = "Coefficients distribution comparison on transition Dementia-free -> Dementia (3-6 years)",
    theme = theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5)))

p1 <- plots_distr500[[3]][[2]] + 
  labs(title =NULL, x=NULL, caption = "500 observations") 
p2 <- plots_distr2K[[3]][[2]] + 
  labs(title= NULL, x=NULL, caption = "2K observations") 
p3 <- plots_distr5K[[3]][[2]] + 
  labs(title= NULL, x=NULL, caption = "5K observations") 
p4 <- plots_distr10K[[3]][[2]] + 
  labs(title= NULL, x=NULL, caption = "10K observations") 

plots_distr_all_trans2 <- ( p1+p2) / (p3+p4) +
                 plot_layout(guides = "collect") + 
  plot_annotation(title = "Coefficients distribution comparison on transition Dementia-free-> Death (3-6 years)",
    theme = theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5)))

p1 <- plots_distr500[[3]][[3]] + 
  labs(title =NULL, x=NULL, caption = "500 observations") 
p2 <- plots_distr2K[[3]][[3]] + 
  labs(title= NULL, x=NULL, caption = "2K observations") 
p3 <- plots_distr5K[[3]][[3]] + 
  labs(title= NULL, x=NULL, caption = "5K observations") 
p4 <- plots_distr10K[[3]][[3]] + 
  labs(title= NULL, x=NULL, caption = "10K observations") 

plots_distr_all_trans3 <- ( p1+p2) / (p3+p4) +
                 plot_layout(guides = "collect") + 
  plot_annotation(title = "Coefficients distribution comparison on transition Dementia-> Death (3-6 years)",
    theme = theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5)))

plots_distr_all_trans1
plots_distr_all_trans2
plots_distr_all_trans3
```